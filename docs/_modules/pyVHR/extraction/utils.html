
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>pyVHR.extraction.utils &#8212; pyVHR 1.0 documentation</title>
    
  <link href="../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/blank.css" />
    
  <link rel="preload" as="script" href="../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    
<a class="navbar-brand" href="../../../index.html">
<p class="title">pyVHR</p>
</a>

    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar"><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <h1>Source code for pyVHR.extraction.utils</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">numba</span> <span class="kn">import</span> <span class="n">prange</span><span class="p">,</span> <span class="n">njit</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>

<div class="viewcode-block" id="get_magic_landmarks"><a class="viewcode-back" href="../../../pyVHR.extraction.html#pyVHR.extraction.utils.get_magic_landmarks">[docs]</a><span class="k">def</span> <span class="nf">get_magic_landmarks</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; returns high_priority and mid_priority list of landmarks identification number &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="n">MagicLandmarks</span><span class="o">.</span><span class="n">forehead_center</span><span class="p">,</span> <span class="o">*</span><span class="n">MagicLandmarks</span><span class="o">.</span><span class="n">cheek_left_bottom</span><span class="p">,</span> <span class="o">*</span><span class="n">MagicLandmarks</span><span class="o">.</span><span class="n">cheek_right_bottom</span><span class="p">],</span> <span class="p">[</span><span class="o">*</span><span class="n">MagicLandmarks</span><span class="o">.</span><span class="n">forehoead_right</span><span class="p">,</span> <span class="o">*</span><span class="n">MagicLandmarks</span><span class="o">.</span><span class="n">forehead_left</span><span class="p">,</span> <span class="o">*</span><span class="n">MagicLandmarks</span><span class="o">.</span><span class="n">cheek_left_top</span><span class="p">,</span> <span class="o">*</span><span class="n">MagicLandmarks</span><span class="o">.</span><span class="n">cheek_right_top</span><span class="p">]</span></div>


<div class="viewcode-block" id="MagicLandmarks"><a class="viewcode-back" href="../../../pyVHR.extraction.html#pyVHR.extraction.utils.MagicLandmarks">[docs]</a><span class="k">class</span> <span class="nc">MagicLandmarks</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class contains usefull lists of landmarks identification numbers.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">high_prio_forehead</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">337</span><span class="p">,</span> <span class="mi">338</span><span class="p">]</span>
    <span class="n">high_prio_nose</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span>
                      <span class="mi">209</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">275</span><span class="p">,</span> <span class="mi">277</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">363</span><span class="p">,</span> <span class="mi">399</span><span class="p">,</span> <span class="mi">419</span><span class="p">,</span> <span class="mi">420</span><span class="p">,</span> <span class="mi">429</span><span class="p">,</span> <span class="mi">437</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">456</span><span class="p">]</span>
    <span class="n">high_prio_left_cheek</span> <span class="o">=</span> <span class="p">[</span><span class="mi">36</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span>
                            <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">206</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">216</span><span class="p">]</span>
    <span class="n">high_prio_right_cheek</span> <span class="o">=</span> <span class="p">[</span><span class="mi">266</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> <span class="mi">329</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">346</span><span class="p">,</span> <span class="mi">347</span><span class="p">,</span>
                             <span class="mi">347</span><span class="p">,</span> <span class="mi">348</span><span class="p">,</span> <span class="mi">355</span><span class="p">,</span> <span class="mi">371</span><span class="p">,</span> <span class="mi">411</span><span class="p">,</span> <span class="mi">423</span><span class="p">,</span> <span class="mi">425</span><span class="p">,</span> <span class="mi">426</span><span class="p">,</span> <span class="mi">427</span><span class="p">,</span> <span class="mi">436</span><span class="p">]</span>

    <span class="n">mid_prio_forehead</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span>
                         <span class="mi">284</span><span class="p">,</span> <span class="mi">297</span><span class="p">,</span> <span class="mi">298</span><span class="p">,</span> <span class="mi">301</span><span class="p">,</span> <span class="mi">332</span><span class="p">,</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">372</span><span class="p">,</span> <span class="mi">383</span><span class="p">]</span>
    <span class="n">mid_prio_nose</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">351</span><span class="p">,</span> <span class="mi">358</span><span class="p">,</span> <span class="mi">412</span><span class="p">]</span>
    <span class="n">mid_prio_left_cheek</span> <span class="o">=</span> <span class="p">[</span><span class="mi">34</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">213</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">234</span><span class="p">]</span>
    <span class="n">mid_prio_right_cheek</span> <span class="o">=</span> <span class="p">[</span><span class="mi">340</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">352</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mi">454</span><span class="p">]</span>
    <span class="n">mid_prio_chin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">135</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span>
                     <span class="mi">214</span><span class="p">,</span> <span class="mi">262</span><span class="p">,</span> <span class="mi">288</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">428</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">431</span><span class="p">,</span> <span class="mi">432</span><span class="p">,</span> <span class="mi">433</span><span class="p">,</span> <span class="mi">434</span><span class="p">]</span>
    <span class="n">mid_prio_mouth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">92</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">322</span><span class="p">,</span> <span class="mi">391</span><span class="p">,</span> <span class="mi">393</span><span class="p">,</span> <span class="mi">410</span><span class="p">]</span>
    <span class="c1"># more specific areas</span>
    <span class="n">forehead_left</span> <span class="o">=</span> <span class="p">[</span><span class="mi">21</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span>
                     <span class="mi">53</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">105</span><span class="p">]</span>
    <span class="n">forehead_center</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">336</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
    <span class="n">forehoead_right</span> <span class="o">=</span> <span class="p">[</span><span class="mi">338</span><span class="p">,</span> <span class="mi">337</span><span class="p">,</span> <span class="mi">336</span><span class="p">,</span> <span class="mi">296</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span> <span class="mi">295</span><span class="p">,</span> <span class="mi">282</span><span class="p">,</span>
                       <span class="mi">334</span><span class="p">,</span> <span class="mi">293</span><span class="p">,</span> <span class="mi">301</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">298</span><span class="p">,</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">297</span><span class="p">,</span> <span class="mi">332</span><span class="p">,</span> <span class="mi">284</span><span class="p">]</span>
    <span class="n">eye_right</span> <span class="o">=</span> <span class="p">[</span><span class="mi">283</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">368</span><span class="p">,</span> <span class="mi">353</span><span class="p">,</span> <span class="mi">264</span><span class="p">,</span> <span class="mi">372</span><span class="p">,</span> <span class="mi">454</span><span class="p">,</span> <span class="mi">340</span><span class="p">,</span> <span class="mi">448</span><span class="p">,</span>
                 <span class="mi">450</span><span class="p">,</span> <span class="mi">452</span><span class="p">,</span> <span class="mi">464</span><span class="p">,</span> <span class="mi">417</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">444</span><span class="p">,</span> <span class="mi">282</span><span class="p">,</span> <span class="mi">276</span><span class="p">,</span> <span class="mi">446</span><span class="p">,</span> <span class="mi">368</span><span class="p">]</span>
    <span class="n">eye_left</span> <span class="o">=</span> <span class="p">[</span><span class="mi">127</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span>
                <span class="mi">35</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">143</span><span class="p">]</span>
    <span class="n">nose</span> <span class="o">=</span> <span class="p">[</span><span class="mi">193</span><span class="p">,</span> <span class="mi">417</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">399</span><span class="p">,</span> <span class="mi">456</span><span class="p">,</span>
            <span class="mi">195</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">281</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="mi">440</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">305</span><span class="p">]</span>
    <span class="n">mounth_up</span> <span class="o">=</span> <span class="p">[</span><span class="mi">186</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">393</span><span class="p">,</span> <span class="mi">322</span><span class="p">,</span> <span class="mi">410</span><span class="p">,</span> <span class="mi">287</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">269</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">164</span><span class="p">]</span>
    <span class="n">mounth_down</span> <span class="o">=</span> <span class="p">[</span><span class="mi">43</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">406</span><span class="p">,</span> <span class="mi">335</span><span class="p">,</span> <span class="mi">273</span><span class="p">,</span> <span class="mi">424</span><span class="p">,</span> <span class="mi">313</span><span class="p">,</span> <span class="mi">194</span><span class="p">,</span> <span class="mi">204</span><span class="p">]</span>
    <span class="n">chin</span> <span class="o">=</span> <span class="p">[</span><span class="mi">204</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">194</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span>
            <span class="mi">200</span><span class="p">,</span> <span class="mi">418</span><span class="p">,</span> <span class="mi">396</span><span class="p">,</span> <span class="mi">369</span><span class="p">,</span> <span class="mi">421</span><span class="p">,</span> <span class="mi">431</span><span class="p">,</span> <span class="mi">379</span><span class="p">,</span> <span class="mi">424</span><span class="p">]</span>
    <span class="n">cheek_left_bottom</span> <span class="o">=</span> <span class="p">[</span><span class="mi">215</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">192</span><span class="p">]</span>
    <span class="n">cheek_right_bottom</span> <span class="o">=</span> <span class="p">[</span><span class="mi">435</span><span class="p">,</span> <span class="mi">427</span><span class="p">,</span> <span class="mi">416</span><span class="p">,</span> <span class="mi">364</span><span class="p">,</span>
                          <span class="mi">394</span><span class="p">,</span> <span class="mi">422</span><span class="p">,</span> <span class="mi">287</span><span class="p">,</span> <span class="mi">410</span><span class="p">,</span> <span class="mi">434</span><span class="p">,</span> <span class="mi">436</span><span class="p">]</span>
    <span class="n">cheek_left_top</span> <span class="o">=</span> <span class="p">[</span><span class="mi">116</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span>
                      <span class="mi">137</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">206</span><span class="p">,</span> <span class="mi">203</span><span class="p">]</span>
    <span class="n">cheek_right_top</span> <span class="o">=</span> <span class="p">[</span><span class="mi">349</span><span class="p">,</span> <span class="mi">348</span><span class="p">,</span> <span class="mi">347</span><span class="p">,</span> <span class="mi">346</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> <span class="mi">447</span><span class="p">,</span> <span class="mi">323</span><span class="p">,</span>
                       <span class="mi">280</span><span class="p">,</span> <span class="mi">352</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">371</span><span class="p">,</span> <span class="mi">358</span><span class="p">,</span> <span class="mi">423</span><span class="p">,</span> <span class="mi">426</span><span class="p">,</span> <span class="mi">425</span><span class="p">,</span> <span class="mi">427</span><span class="p">,</span> <span class="mi">411</span><span class="p">,</span> <span class="mi">376</span><span class="p">]</span>
    <span class="c1"># dense zones used for convex hull masks</span>
    <span class="n">left_eye</span> <span class="o">=</span> <span class="p">[</span><span class="mi">157</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">124</span><span class="p">]</span>
    <span class="n">right_eye</span> <span class="o">=</span> <span class="p">[</span><span class="mi">384</span><span class="p">,</span> <span class="mi">385</span><span class="p">,</span> <span class="mi">386</span><span class="p">,</span> <span class="mi">259</span><span class="p">,</span> <span class="mi">388</span><span class="p">,</span> <span class="mi">261</span><span class="p">,</span> <span class="mi">265</span><span class="p">,</span> <span class="mi">398</span><span class="p">,</span> <span class="mi">276</span><span class="p">,</span> <span class="mi">282</span><span class="p">,</span> <span class="mi">283</span><span class="p">,</span> <span class="mi">285</span><span class="p">,</span> <span class="mi">413</span><span class="p">,</span> <span class="mi">293</span><span class="p">,</span> <span class="mi">296</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">441</span><span class="p">,</span> <span class="mi">442</span><span class="p">,</span> <span class="mi">445</span><span class="p">,</span> <span class="mi">446</span><span class="p">,</span> <span class="mi">449</span><span class="p">,</span> <span class="mi">451</span><span class="p">,</span> <span class="mi">334</span><span class="p">,</span> <span class="mi">463</span><span class="p">,</span> <span class="mi">336</span><span class="p">,</span> <span class="mi">464</span><span class="p">,</span> <span class="mi">467</span><span class="p">,</span> <span class="mi">339</span><span class="p">,</span> <span class="mi">341</span><span class="p">,</span> <span class="mi">342</span><span class="p">,</span> <span class="mi">353</span><span class="p">,</span> <span class="mi">381</span><span class="p">,</span> <span class="mi">373</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">255</span><span class="p">]</span>
    <span class="n">mounth</span> <span class="o">=</span> <span class="p">[</span><span class="mi">391</span><span class="p">,</span> <span class="mi">393</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">269</span><span class="p">,</span> <span class="mi">270</span><span class="p">,</span> <span class="mi">271</span><span class="p">,</span> <span class="mi">287</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">313</span><span class="p">,</span> <span class="mi">314</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">315</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">321</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">335</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">106</span><span class="p">]</span>
    <span class="c1"># equispaced facial points - mouth and eyes are excluded.</span>
    <span class="n">equispaced_facial_points</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> \
             <span class="mi">58</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> \
             <span class="mi">118</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">193</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">206</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> \
             <span class="mi">210</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">262</span><span class="p">,</span> <span class="mi">265</span><span class="p">,</span> <span class="mi">266</span><span class="p">,</span> <span class="mi">273</span><span class="p">,</span> <span class="mi">277</span><span class="p">,</span> <span class="mi">278</span><span class="p">,</span> <span class="mi">280</span><span class="p">,</span> \
             <span class="mi">284</span><span class="p">,</span> <span class="mi">288</span><span class="p">,</span> <span class="mi">297</span><span class="p">,</span> <span class="mi">299</span><span class="p">,</span> <span class="mi">322</span><span class="p">,</span> <span class="mi">323</span><span class="p">,</span> <span class="mi">330</span><span class="p">,</span> <span class="mi">332</span><span class="p">,</span> <span class="mi">333</span><span class="p">,</span> <span class="mi">337</span><span class="p">,</span> <span class="mi">338</span><span class="p">,</span> <span class="mi">345</span><span class="p">,</span> \
             <span class="mi">346</span><span class="p">,</span> <span class="mi">361</span><span class="p">,</span> <span class="mi">363</span><span class="p">,</span> <span class="mi">364</span><span class="p">,</span> <span class="mi">367</span><span class="p">,</span> <span class="mi">368</span><span class="p">,</span> <span class="mi">371</span><span class="p">,</span> <span class="mi">377</span><span class="p">,</span> <span class="mi">379</span><span class="p">,</span> <span class="mi">411</span><span class="p">,</span> <span class="mi">412</span><span class="p">,</span> <span class="mi">417</span><span class="p">,</span> <span class="mi">421</span><span class="p">,</span> <span class="mi">425</span><span class="p">,</span> <span class="mi">426</span><span class="p">,</span> <span class="mi">427</span><span class="p">,</span> <span class="mi">430</span><span class="p">,</span> <span class="mi">432</span><span class="p">,</span> <span class="mi">436</span><span class="p">]</span></div>

<div class="viewcode-block" id="draw_rects"><a class="viewcode-back" href="../../../pyVHR.extraction.html#pyVHR.extraction.utils.draw_rects">[docs]</a><span class="nd">@njit</span><span class="p">(</span><span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">draw_rects</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">xcenters</span><span class="p">,</span> <span class="n">ycenters</span><span class="p">,</span> <span class="n">xsides</span><span class="p">,</span> <span class="n">ysides</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method is used to draw N rectangles on a image.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xcenters</span><span class="p">)):</span>
        <span class="n">leftx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xcenters</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">xsides</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">rightx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xcenters</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">xsides</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">topy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ycenters</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">-</span> <span class="n">ysides</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">bottomy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">ycenters</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">+</span> <span class="n">ysides</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">leftx</span><span class="p">,</span> <span class="n">rightx</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">topy</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">image</span><span class="p">[</span><span class="n">topy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">image</span><span class="p">[</span><span class="n">topy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">image</span><span class="p">[</span><span class="n">topy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">bottomy</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">image</span><span class="p">[</span><span class="n">bottomy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">image</span><span class="p">[</span><span class="n">bottomy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">image</span><span class="p">[</span><span class="n">bottomy</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">topy</span><span class="p">,</span> <span class="n">bottomy</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">leftx</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">leftx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">leftx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">leftx</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">rightx</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">rightx</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">rightx</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">image</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">rightx</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">image</span></div>

<div class="viewcode-block" id="sig_windowing"><a class="viewcode-back" href="../../../pyVHR.extraction.html#pyVHR.extraction.utils.sig_windowing">[docs]</a><span class="k">def</span> <span class="nf">sig_windowing</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">wsize</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">fps</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method is used to divide a RGB signal into overlapping windows.</span>

<span class="sd">    Args:</span>
<span class="sd">        sig (float32 ndarray): ndarray with shape [num_frames, num_estimators, rgb_channels].</span>
<span class="sd">        wsize (float): window size in seconds.</span>
<span class="sd">        stride (float): stride between overlapping windows in seconds.</span>
<span class="sd">        fps (float): frames per seconds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        windowed signal as a list of length num_windows of float32 ndarray with shape [num_estimators, rgb_channels, window_frames],</span>
<span class="sd">        and a 1D ndarray of times in seconds,where each one is the center of a window.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">block_idx</span><span class="p">,</span> <span class="n">timesES</span> <span class="o">=</span> <span class="n">sliding_straded_win_offline</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">wsize</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">fps</span><span class="p">)</span>
    <span class="n">block_signals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">block_idx</span><span class="p">:</span>
        <span class="n">st_frame</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">end_frame</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">wind_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">sig</span><span class="p">[</span><span class="n">st_frame</span><span class="p">:</span> <span class="n">end_frame</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">wind_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">wind_signal</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">wind_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">wind_signal</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">block_signals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wind_signal</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">block_signals</span><span class="p">,</span> <span class="n">timesES</span></div>

<div class="viewcode-block" id="raw_windowing"><a class="viewcode-back" href="../../../pyVHR.extraction.html#pyVHR.extraction.utils.raw_windowing">[docs]</a><span class="k">def</span> <span class="nf">raw_windowing</span><span class="p">(</span><span class="n">raw_signal</span><span class="p">,</span> <span class="n">wsize</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">fps</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method is used to divide a Raw signal into overlapping windows.</span>

<span class="sd">    Args:</span>
<span class="sd">        sig (float32 ndarray): ndarray of images with shape [num_frames, rows, columns, rgb_channels].</span>
<span class="sd">        wsize (float): window size in seconds.</span>
<span class="sd">        stride (float): stride between overlapping windows in seconds.</span>
<span class="sd">        fps (float): frames per seconds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        windowed signal as a list of length num_windows of float32 ndarray with shape [num_frames, rows, columns, rgb_channels],</span>
<span class="sd">        and a 1D ndarray of times in seconds,where each one is the center of a window.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">N</span> <span class="o">=</span> <span class="n">raw_signal</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">block_idx</span><span class="p">,</span> <span class="n">timesES</span> <span class="o">=</span> <span class="n">sliding_straded_win_offline</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">wsize</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">fps</span><span class="p">)</span>
    <span class="n">block_signals</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">block_idx</span><span class="p">:</span>
        <span class="n">st_frame</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">end_frame</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">wind_signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">raw_signal</span><span class="p">[</span><span class="n">st_frame</span><span class="p">:</span> <span class="n">end_frame</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">block_signals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wind_signal</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">block_signals</span><span class="p">,</span> <span class="n">timesES</span></div>

<div class="viewcode-block" id="sliding_straded_win_offline"><a class="viewcode-back" href="../../../pyVHR.extraction.html#pyVHR.extraction.utils.sliding_straded_win_offline">[docs]</a><span class="k">def</span> <span class="nf">sliding_straded_win_offline</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">wsize</span><span class="p">,</span> <span class="n">stride</span><span class="p">,</span> <span class="n">fps</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method is used to compute all the info for creating an overlapping windows signal.</span>

<span class="sd">    Args:</span>
<span class="sd">        N (int): length of the signal.</span>
<span class="sd">        wsize (float): window size in seconds.</span>
<span class="sd">        stride (float): stride between overlapping windows in seconds.</span>
<span class="sd">        fps (float): frames per seconds.</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of ranges, each one contains the indices of a window, and a 1D ndarray of times in seconds, where each one is the center of a window.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">wsize_fr</span> <span class="o">=</span> <span class="n">wsize</span><span class="o">*</span><span class="n">fps</span>
    <span class="n">stride_fr</span> <span class="o">=</span> <span class="n">stride</span><span class="o">*</span><span class="n">fps</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">timesES</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">num_win</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">N</span><span class="o">-</span><span class="n">wsize_fr</span><span class="p">)</span><span class="o">/</span><span class="n">stride_fr</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_win</span><span class="p">):</span>
        <span class="n">idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">s</span><span class="o">+</span><span class="n">wsize_fr</span><span class="p">))</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">stride_fr</span>
        <span class="n">timesES</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wsize</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">stride</span><span class="o">*</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">idx</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">timesES</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_fps"><a class="viewcode-back" href="../../../pyVHR.extraction.html#pyVHR.extraction.utils.get_fps">[docs]</a><span class="k">def</span> <span class="nf">get_fps</span><span class="p">(</span><span class="n">videoFileName</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method returns the fps of a video file name or path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vidcap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="n">videoFileName</span><span class="p">)</span>
    <span class="n">fps</span> <span class="o">=</span> <span class="n">vidcap</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">CAP_PROP_FPS</span><span class="p">)</span>
    <span class="n">vidcap</span><span class="o">.</span><span class="n">release</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fps</span></div>

<div class="viewcode-block" id="extract_frames_yield"><a class="viewcode-back" href="../../../pyVHR.extraction.html#pyVHR.extraction.utils.extract_frames_yield">[docs]</a><span class="k">def</span> <span class="nf">extract_frames_yield</span><span class="p">(</span><span class="n">videoFileName</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method yield the frames of a video file name or path.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">vidcap</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">VideoCapture</span><span class="p">(</span><span class="n">videoFileName</span><span class="p">)</span>
    <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="n">vidcap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">while</span> <span class="n">success</span><span class="p">:</span>
        <span class="k">yield</span> <span class="n">image</span>
        <span class="n">success</span><span class="p">,</span> <span class="n">image</span> <span class="o">=</span> <span class="n">vidcap</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">vidcap</span><span class="o">.</span><span class="n">release</span><span class="p">()</span></div>
</pre></div>

              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, phuselab.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.2.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>